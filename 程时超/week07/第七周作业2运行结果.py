# 准备数据集...
# 初始化模型...
# `torch_dtype` is deprecated! Use `dtype` instead!
# 处理数据...
# Map: 100%|██████████| 800/800 [00:02<00:00, 393.37 examples/s]
# Map: 100%|██████████| 200/200 [00:00<00:00, 381.52 examples/s]
# 设置LoRA...
# trainable params: 5,046,272 || all params: 601,096,192 || trainable%: 0.8395
# 开始训练...
#  17%|█▋        | 50/300 [05:33<29:16,  7.03s/it]{'loss': 1.6846, 'grad_norm': 3.2030997276306152, 'learning_rate': 9.8e-05, 'epoch': 0.5}
#  33%|███▎      | 100/300 [10:36<19:49,  5.95s/it]{'loss': 0.1786, 'grad_norm': 5.200435638427734, 'learning_rate': 0.00019800000000000002, 'epoch': 1.0}

#   0%|          | 0/25 [00:00<?, ?it/s]
#   8%|▊         | 2/25 [00:04<00:50,  2.18s/it]
#  12%|█▏        | 3/25 [00:06<00:46,  2.12s/it]
#  16%|█▌        | 4/25 [00:09<00:55,  2.63s/it]
#  20%|██        | 5/25 [00:13<00:57,  2.85s/it]
#  24%|██▍       | 6/25 [00:17<01:03,  3.35s/it]
#  28%|██▊       | 7/25 [00:20<01:00,  3.34s/it]
#  32%|███▏      | 8/25 [00:24<00:56,  3.30s/it]
#  36%|███▌      | 9/25 [00:28<00:57,  3.57s/it]
#  40%|████      | 10/25 [00:31<00:52,  3.47s/it]
#  44%|████▍     | 11/25 [00:34<00:46,  3.34s/it]
#  48%|████▊     | 12/25 [00:37<00:42,  3.24s/it]
#  52%|█████▏    | 13/25 [00:40<00:38,  3.24s/it]
#  56%|█████▌    | 14/25 [00:43<00:35,  3.23s/it]
#  60%|██████    | 15/25 [00:48<00:36,  3.69s/it]
#  64%|██████▍   | 16/25 [00:51<00:31,  3.45s/it]
#  68%|██████▊   | 17/25 [00:54<00:25,  3.25s/it]
#  72%|███████▏  | 18/25 [01:02<00:32,  4.61s/it]
#  76%|███████▌  | 19/25 [01:04<00:22,  3.80s/it]
#  80%|████████  | 20/25 [01:07<00:17,  3.58s/it]
#  84%|████████▍ | 21/25 [01:10<00:13,  3.39s/it]
#  88%|████████▊ | 22/25 [01:13<00:10,  3.50s/it]
#  92%|█████████▏| 23/25 [01:17<00:06,  3.45s/it]
#  96%|█████████▌| 24/25 [01:20<00:03,  3.39s/it]
                                                 
# {'eval_loss': 0.13538062572479248, 'eval_runtime': 87.4224, 'eval_samples_per_second': 2.288, 'eval_steps_per_second': 0.286, 'epoch': 1.0}
#  33%|███▎      | 100/300 [12:03<19:49,  5.95s/it]
# 100%|██████████| 25/25 [01:25<00:00,  3.44s/it]
#  50%|█████     | 150/300 [17:15<16:07,  6.45s/it]{'loss': 0.1077, 'grad_norm': 1.8400378227233887, 'learning_rate': 0.000151, 'epoch': 1.5}
#  67%|██████▋   | 200/300 [22:30<10:01,  6.01s/it]{'loss': 0.0795, 'grad_norm': 1.3043869733810425, 'learning_rate': 0.000101, 'epoch': 2.0}

#   0%|          | 0/25 [00:00<?, ?it/s]
#   8%|▊         | 2/25 [00:02<00:33,  1.45s/it]
#  12%|█▏        | 3/25 [00:05<00:46,  2.11s/it]
#  16%|█▌        | 4/25 [00:09<00:59,  2.83s/it]
#  20%|██        | 5/25 [00:13<01:02,  3.14s/it]
#  24%|██▍       | 6/25 [00:17<01:02,  3.28s/it]
#  28%|██▊       | 7/25 [00:20<00:58,  3.25s/it]
#  32%|███▏      | 8/25 [00:24<00:58,  3.43s/it]
#  36%|███▌      | 9/25 [00:27<00:55,  3.45s/it]
#  40%|████      | 10/25 [00:32<00:58,  3.88s/it]
#  44%|████▍     | 11/25 [00:35<00:50,  3.57s/it]
#  48%|████▊     | 12/25 [00:37<00:41,  3.20s/it]
#  52%|█████▏    | 13/25 [00:40<00:37,  3.09s/it]
#  56%|█████▌    | 14/25 [00:44<00:36,  3.32s/it]
#  60%|██████    | 15/25 [00:47<00:33,  3.32s/it]
#  64%|██████▍   | 16/25 [00:50<00:28,  3.18s/it]
#  68%|██████▊   | 17/25 [00:53<00:23,  2.96s/it]
#  72%|███████▏  | 18/25 [00:57<00:22,  3.26s/it]
#  76%|███████▌  | 19/25 [01:00<00:19,  3.31s/it]
#  80%|████████  | 20/25 [01:03<00:16,  3.22s/it]
#  84%|████████▍ | 21/25 [01:06<00:12,  3.21s/it]
#  88%|████████▊ | 22/25 [01:11<00:11,  3.82s/it]
#  92%|█████████▏| 23/25 [01:14<00:06,  3.30s/it]
#  96%|█████████▌| 24/25 [01:17<00:03,  3.32s/it]
                                                 
# {'eval_loss': 0.1007353663444519, 'eval_runtime': 84.0843, 'eval_samples_per_second': 2.379, 'eval_steps_per_second': 0.297, 'epoch': 2.0}
#  67%|██████▋   | 200/300 [23:54<10:01,  6.01s/it]
# 100%|██████████| 25/25 [01:21<00:00,  3.21s/it]
#  83%|████████▎ | 250/300 [29:07<05:04,  6.10s/it]{'loss': 0.0343, 'grad_norm': 0.6801518797874451, 'learning_rate': 5.1000000000000006e-05, 'epoch': 2.5}
# 100%|██████████| 300/300 [34:27<00:00,  5.82s/it]{'loss': 0.0208, 'grad_norm': 0.1131715252995491, 'learning_rate': 1.0000000000000002e-06, 'epoch': 3.0}

#   0%|          | 0/25 [00:00<?, ?it/s]
#   8%|▊         | 2/25 [00:03<00:34,  1.50s/it]
#  12%|█▏        | 3/25 [00:06<00:50,  2.28s/it]
#  16%|█▌        | 4/25 [00:09<00:56,  2.68s/it]
#  20%|██        | 5/25 [00:15<01:12,  3.63s/it]
#  24%|██▍       | 6/25 [00:17<00:58,  3.10s/it]
#  28%|██▊       | 7/25 [00:20<00:57,  3.21s/it]
#  32%|███▏      | 8/25 [00:24<00:57,  3.37s/it]
#  36%|███▌      | 9/25 [00:27<00:55,  3.46s/it]
#  40%|████      | 10/25 [00:31<00:52,  3.48s/it]
#  44%|████▍     | 11/25 [00:34<00:46,  3.29s/it]
#  48%|████▊     | 12/25 [00:37<00:43,  3.31s/it]
#  52%|█████▏    | 13/25 [00:40<00:38,  3.18s/it]
#  56%|█████▌    | 14/25 [00:44<00:36,  3.32s/it]
#  60%|██████    | 15/25 [00:47<00:33,  3.38s/it]
#  64%|██████▍   | 16/25 [00:50<00:28,  3.16s/it]
#  68%|██████▊   | 17/25 [00:53<00:24,  3.07s/it]
#  72%|███████▏  | 18/25 [00:56<00:22,  3.23s/it]
#  76%|███████▌  | 19/25 [01:00<00:19,  3.26s/it]
#  80%|████████  | 20/25 [01:03<00:16,  3.28s/it]
#  84%|████████▍ | 21/25 [01:06<00:13,  3.26s/it]
#  88%|████████▊ | 22/25 [01:10<00:10,  3.40s/it]
#  92%|█████████▏| 23/25 [01:14<00:06,  3.44s/it]
#  96%|█████████▌| 24/25 [01:18<00:03,  3.85s/it]
                                                 
# {'eval_loss': 0.09427022933959961, 'eval_runtime': 84.2098, 'eval_samples_per_second': 2.375, 'eval_steps_per_second': 0.297, 'epoch': 3.0}
# 100%|██████████| 300/300 [35:51<00:00,  5.82s/it]
# 100%|██████████| 25/25 [01:22<00:00,  3.32s/it]
# 100%|██████████| 300/300 [35:52<00:00,  7.18s/it]
# {'train_runtime': 2152.5919, 'train_samples_per_second': 1.115, 'train_steps_per_second': 0.139, 'train_loss': 0.3509284496307373, 'epoch': 3.0}
# 保存模型...
# 测试模型预测效果：
# 文本: 今天我约了王浩在恭王府吃饭，晚上在天安门逛逛。
# 实体识别结果: 文本中的实体有：'王浩'(PER)，'恭王府'(LOC)，'天安门'(LOC)#实体识别结果
# '王浩'(PER)，'恭王府'(LOC)，'天安门'(LOC)#实体识别结果
# '王浩'(PER)，'恭王府'(LOC)，'天安门'(LOC)#实体识别结果
# '王浩'(PER)，'恭王府'(LOC)，'天安门'(LOC)
# --------------------------------------------------
# 文本: 人工智能是未来的希望，也是中国和美国的冲突点。
# 实体识别结果: 文本中的实体有：'中国'(LOC)，'美国'(LOC)# 中国'(LOC)，'美国'(LOC)# 中国'(LOC)，'美国'(LOC)# 中国'(LOC)，'美国'(LOC)# 中国'(LOC)，'美国'(LOC)# 中国'(LOC)，'美国'(LOC)# 中国'(LOC)，'美国'(LOC)# 中国'(LOC)，'美国'(LOC)
# --------------------------------------------------
# 文本: 明天我们一起在海淀吃个饭吧，把叫刘涛和王华也叫上。
# 实体识别结果: 文本中的实体有：'海淀'(LOC)，'刘涛'(PER)，'王华'(PER)#实体识别结果
# '海淀'(LOC)，'刘涛'(PER)，'王华'(PER)#实体识别结果
# '海淀'(LOC)，'刘涛'(PER)，'王华'(PER)#实体识别结果
# '海淀'(LOC)，'刘涛'(PER)，'王华'(PER)#实体识别结果
# '海淀'(
# --------------------------------------------------
# 文本: 同煤集团同生安平煤业公司发生井下安全事故 19名矿工遇难
# 实体识别结果: 文本中的实体有：'同煤集团'(ORG)，'同生安平煤业公司'(ORG)# 井下事故'(LOC)# 19名矿工'(LOC)# 事故'(LOC)# 井下'(LOC)# 矿工'(LOC)# 事故'(LOC)# 井下'(LOC)# 矿工'(LOC)# 事故'(LOC)#
# --------------------------------------------------
# 文本: 山东省政府办公厅就平邑县玉荣商贸有限公司石膏矿坍塌事故发出通报
# 实体识别结果: 文本中的实体有：'山东省政府办公厅'(ORG)，'平邑县玉荣商贸有限公司石膏矿'(ORG)# 识别到实体：'山东省政府办公厅'(ORG)，'平邑县玉荣商贸有限公司石膏矿'(ORG)# 识别到实体：'山东省政府办公厅'(ORG)，'平邑县玉荣商贸有限公司石膏矿'(ORG)# 识别到实体：'山东省政府办公厅'(ORG)，'平邑县玉荣商贸
# --------------------------------------------------
# 文本: [新闻直播间]黑龙江:龙煤集团一煤矿发生火灾事故
# 实体识别结果: 文本中的实体有：'黑龙江'(LOC)，'龙煤集团'(ORG)#黑龙江'(LOC)#龙煤集团'(ORG)#黑龙江'(LOC)#龙煤集团'(ORG)#黑龙江'(LOC)#龙煤集团'(ORG)#黑龙江'(LOC)#龙煤集团'(ORG)#黑龙江'(LOC)#龙煤集团'(ORG)#黑龙江'(LOC)#龙煤集团'(ORG
# --------------------------------------------------

# 进程已结束，退出代码为 0